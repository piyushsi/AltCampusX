!function(){"use strict";var t=!0,e="https://salespanel.io",n=window.location.search.substring(1);try{var o=JSON.parse('{"'+n.replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}')}catch(t){o={}}var r="true"==o.spdebug,a=console.log;function c(){var t=document.getElementById("mytrackingscript");return t?t.getAttribute("data-client"):window.__sp}function s(){r&&a.apply(console,arguments)}function u(t){try{document.cookie="cookietest=1"+(t?"; domain="+t:"");var e=-1!=document.cookie.indexOf("cookietest=");return document.cookie="cookietest=1; expires=Thu, 01-Jan-1970 00:00:01 GMT"+(t?"; domain="+t:""),e}catch(t){return!1}}function d(t,e,n){if(n){var o=new Date;o.setTime(o.getTime()+24*n*60*60*1e3);var i="; expires="+o.toGMTString()}else i="";var r=t+"="+e+i+";path=/;";(void 0===window.__sp_subdomains||window.__sp_subdomains)&&(r+="domain="+function(){for(var t=0,e=document.domain,n=e.split("."),o="_gd"+(new Date).getTime();t<n.length-1&&-1==document.cookie.indexOf(o+"="+o);)e=n.slice(-1-++t).join("."),document.cookie=o+"="+o+";domain="+e+";";return document.cookie=o+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;domain="+e+";","localhost"!==e?"."+e:e}()+";"),document.cookie=r}function l(t){for(var e=t+"=",n=document.cookie.split(";"),o=0;o<n.length;o++){for(var i=n[o];" "==i.charAt(0);)i=i.substring(1,i.length);if(0==i.indexOf(e))return i.substring(e.length,i.length)}return null}function f(t){if(u()){var e;if(null==(e=l("track_uid"))){var n=function(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}();d("track_uid",n,365),e=n}p(t,e)}}function p(n,o){s(n);var i=c(),r=e+"/apiv1/track/",a=l("track_uid"),u=document.referrer,f=document.title,h=new URL(r);h.searchParams.set("title",f),h.searchParams.set("referrer",u),h.searchParams.set("sp_id",a),h.searchParams.set("client_id",i),h.searchParams.set("url",encodeURI(n)),s(h);var v=new XMLHttpRequest;v.open("GET",h),v.send(null),v.onreadystatechange=function(){if(4===v.readyState){s("res",v.response);var t=JSON.parse(v.response);!0===t.email&&o!=t.sp_id&&d("track_uid",t.sp_id,365)}},function(e){var n=document.getElementsByTagName("input"),o=[];o.push(n),document.addEventListener("click",function(t){c()}),document.addEventListener("keydown",function(t){"Tab"==t.key&&c()});try{for(var i=document.getElementsByTagName("iframe"),r=0;r<i.length;r++){var a=i[r].contentDocument;a&&(i[r].contentWindow.onload=function(){var t=this.document.getElementsByTagName("input");this.document.addEventListener("click",function(t){c()}),this.document.addEventListener("keydown",function(t){"Tab"==t.key&&c()}),s("j, iframe_inputs: ",r,t),o.push(t)})}}catch(t){s("Error accessing iframe: no permission: ",t)}function c(){s("inputs_array",o);for(var e=0;e<o.length;e++)for(var n=0;n<o[e].length;n++)if(void 0!==o[e][n]||null!=o[e][n]){var i=o[e][n].value||"";if(g.test(i)&&t){t=!1;o[e][n].getAttribute("name");var r=m(m(document.URL,"form_action","filled_web_form"),"sp_em",i);p(r)}}}}()}function m(t,e,n){if(!t)return t;var o=t.indexOf("#"),i=t.indexOf("?");return i>-1?o>=0&&o<i?t.substr(0,o)+"?"+e+"="+n+t.substr(o,t.length):t.substr(0,i+1)+e+"="+n+"&"+t.substr(i+1,t.length):o>-1?t.substr(0,o)+"?"+e+"="+n+t.substr(o,t.length):t+"?"+e+"="+n}f(document.URL),window.addEventListener("unload",function(){var t=e+"/apiv1/page-visit-beacon/",n={};n.client_id=c(),n.sp_id=l("track_uid"),n.page_url=document.URL,navigator.sendBeacon(t,JSON.stringify(n))}),window.onhashchange=function(){f(document.URL)};var g=/^[a-zA-Z0-9\.!#$%&*+=?^_~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+$/;var h=window.$salespanel||[],v={};v.Actions=new(function(){function t(){this.ns="spactions",this.availableActionItems=["actionitem"],this.actionsForActionItem={actionitem:["set","get"]}}function e(){this.ns="identify",this.availableActionItems=["email"],this.actionsForActionItem={email:["set"]}}function n(){this.actionNamespace=["identify"],this.actionNamespaceMapping={identify:e}}return t.prototype.getString=function(t){return this.ns+t},t.prototype.get_action_item_from_args=function(t){try{var e=t.split(/:(.+)/),n=e[0],o=e[1];return n!==this.ns?(console.log("Error: Invalid action",t),!1):o}catch(t){return console.log(t),!1}},t.prototype.perform_check=function(t,e){var n=this.get_action_item_from_args(t);return n?-1===this.availableActionItems.indexOf(n)?(console.log("Error: ActionItem not found: ",t),!1):-1!==this.actionsForActionItem[n].indexOf(e)||(console.log("Error: Action not found: ",e),!1):(console.log("Error: ActionItem not found: ",t),!1)},t.prototype.get_action=function(t,e){if(this.perform_check(t,e))switch(e){case"get":case"set":return console.log("function definition needed"),!1;default:return console.log("action not recongnized"),!1}},t.prototype.perform_action=function(t,e,n){(e=this.get_action(t,e))&&e(n)},e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.prototype.get_action=function(t,e){if(this.perform_check(t,e))switch(e){case"set":return function(t){var e=t[0],n=t[1]?t[1]:"sdk";g.test(e)?p(m(m(document.URL,"source",n),"sp_em",e)):console.log("Invalid Email",t[0])};default:return console.log("action not recongnized"),!1}},n.prototype.getAction=function(t){try{var e=t.split(/:(.+)/)[0];return-1===this.actionNamespace.indexOf(e)?(console.log("Error: Invalid action",t),!1):new this.actionNamespaceMapping[e]}catch(t){return console.log(t),!1}},n}()),v.Execute=new(function(){function t(){}return t.prototype.perform_target_action=function(t){var e=t[0],n=t[1],o=v.Actions.getAction(n),i=t.slice(2);if(o){var r=o.get_action(n,e);r&&r(i)}},t.prototype.push=function(t){return this.perform_target_action(t)},t}());var _={push:function(t){if(u())return v.Execute.push(t)}};for(window.$salespanel=_;h.length>0;)window.$salespanel.push(h.shift(i))}();